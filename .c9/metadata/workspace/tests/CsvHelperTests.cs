{"filter":false,"title":"CsvHelperTests.cs","tooltip":"/tests/CsvHelperTests.cs","undoManager":{"mark":10,"position":10,"stack":[[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":59,"column":0},"action":"insert","lines":["using System;","using System.Linq;","using System.Configuration;","using System.Data;","using System.Diagnostics;","using System.IO;","using CsvHelper;","using FluentAssertions;","using Insight.Database;","using Xunit;","using JA.FIPA.Data;","","namespace JA.FIPA.SimpleEtl","{","    public class CsvHelperTests","    {","        public ConnectionStringSettings TestDb { get; private set; }","        public ConnectionStringSettings JdsFipaDb { get; private set; }","        public CsvHelperTests()","        {","            TestDb = ConfigurationManager.ConnectionStrings[\"LocalTestDb\"];","            JdsFipaDb = ConfigurationManager.ConnectionStrings[\"JDS.FIPA\"];","        }","","        [Fact]","        public void CanConnectToLocalDb()","        {","            var connectSettings = TestDb;","            connectSettings.Invoking(settings =>","            {","                using (settings.Open())","                {","                }","            }).ShouldNotThrow();","        }","","        [Fact]","        public void CanWriteCsvFromDataReader()","        {","            using (var conn = JdsFipaDb.Open())","            {","                using (var reader = Db.getDateDetailsDataReader(conn, DateTime.Parse(\"2013/06/30\"),","                        DateTime.Parse(\"2014/12/31\")))","                {","                    using (var stringWriter = new StringWriter())","                    {","                        using (var writer = new CsvFactory().CreateWriter(stringWriter))","                        {                            ","                            writer.WriteRecords(reader);","                            var text = stringWriter.ToString();","                            Debug.WriteLine(text);","                            text.Should().NotBeEmpty();","                        }","                    }","                }","            }","        }","    }","}",""]}]}],[{"group":"doc","deltas":[{"start":{"row":10,"column":0},"end":{"row":11,"column":0},"action":"remove","lines":["using JA.FIPA.Data;",""]}]}],[{"group":"doc","deltas":[{"start":{"row":11,"column":10},"end":{"row":11,"column":27},"action":"remove","lines":["JA.FIPA.SimpleEtl"]},{"start":{"row":11,"column":10},"end":{"row":11,"column":36},"action":"insert","lines":["Eleven19.ActiveEtl.Writers"]}]}],[{"group":"doc","deltas":[{"start":{"row":20,"column":0},"end":{"row":20,"column":75},"action":"remove","lines":["            JdsFipaDb = ConfigurationManager.ConnectionStrings[\"JDS.FIPA\"];"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":75},"end":{"row":20,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":0},"end":{"row":16,"column":71},"action":"remove","lines":["        public ConnectionStringSettings JdsFipaDb { get; private set; }"]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":68},"end":{"row":16,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":30},"end":{"row":36,"column":37},"action":"remove","lines":["JdsFipa"]},{"start":{"row":36,"column":30},"end":{"row":36,"column":31},"action":"insert","lines":["T"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":31},"end":{"row":36,"column":32},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":32},"end":{"row":36,"column":33},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":33},"end":{"row":36,"column":34},"action":"insert","lines":["t"]}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":11,"column":10},"end":{"row":11,"column":28},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1426885895764,"hash":"78f9373db432033979da2532d92cad369ed52448"}